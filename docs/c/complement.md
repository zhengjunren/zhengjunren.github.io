---
title: 补充
date: 2021-01-04
---
## 带参数的main函数
创建`test.c`源文件<br/>
在 cmd 控制台中输入 `test.exe I love China`<br/>
该字符串中有三个空格，agrc 的值为 4<br/>
```c
#include <stdio.h>

int main(int argc, char *argv[]) {
    for (int i = 0; i < argc; i++) {
        printf("agrc%d: %s\n", i, argv[i]);
    }
    return 0;
}
```
输出值为
```c
agrc0: test.exe
agrc1: I
agrc2: love
agrc3: China
```

## void 指针
1. C99允许使用基类型为void的指针
2. 指向void类型 可理解为“指向空类型”或者“不指向确定的类型”。也就是说所指向的数据类型的字节长度不确定。
```c
#include <stdio.h>

int main() {
    int a = 3, *p1;
    p1 = &a;
    char ch = 'B', *p2;
    p2 = &ch;
    // 也可以不写强制转换，因为会进行隐式的数据类型转换
    void *p3 = (void *)p1;
    // p2 = p1; 报错，数据类型并不兼容
    // printf("%d\n", *p3); 因为 p3 是void
    // *类型，不指向确定类型的指针，所以不能通过*p3访问a
    printf("%d\n", *(int *)p3);

    p3 = p2;
    printf("%c\n", *(char *)p3);
    return 0;
}
```

## 枚举
指将变量的值一一列出来,变量的值只限于列举出来的值的范围内.

定义枚举类型的一般形式：

enum 枚举名{ 枚举元素表列 } 枚举变量表列;

可以定义在函数内部或者函数外部，枚举名和枚举变量至少有一个即可，如果有变量，可以对变量进行初始化，定义枚举元素时也可显示的指定数值。
```c
#include <stdio.h>
// 只定义枚举名
enum A { a1, a2, a3, a4 };
// 定义枚举名，并给部分枚举元素赋值
enum B { b1 = 3, b2, b3, b4 = 2, b5, b6, b7 };
// 定义枚举类型和枚举变量
enum C { c1, c2, c3 } n;
// 定义枚举类型变量，而不定义枚举名
enum { d1, d2, d3 } m;
// 定义枚举变量并为其初始化
enum E { e1, e2, e3 } k = e2;
int main() {
    // a2 是 enum A 类型的常量
    enum A w = a2;
    // w = 1; 报错！两者数据类型不同
    w = (enum A)1;
    // 输出 1
    printf("%d\n", w);
    // a2 = (enum A)10; 报错！因为 a2 是一个常量
    // 在编译时会根据枚举元素定义的顺序分别给它们一个默认值
    // 输出 0 1 2 3
    printf("%d %d %d %d\n", a1, a2, a3, a4);
    // 输出3 4 5 2 3 4 5
    // 定义枚举类型时可为枚举元素指定一个值，
    // 未指定的元素的值将是前一个元素加 1 的值
    printf("%d %d %d %d %d %d %d", b1, b2, b3, b4, b5, b6, b7);
}
```

## 位段
1. 由来：有时候存储数据的时候用不了1个字节，比如用0和1表示真假，其实用一个位就可以了。所以我们常常可以在一个字节里存放多个信息。
2. 位段：c允许在一个结构体中以位为单位指定其成员所占内存长度，这种以位为单位的成员称为“位段”或称“位域”。利用位段能用较少的位数存储数据
```c
struct A {
    unsigned a: 2;
    unsigned b: 4;
    unsigned c: 2;
    short m;
} data;
```
其中a, b, c段分别占2,4,2位，m为short型。位段的空间分配方向因机器而已，一般是由右到左进行分配的（如下图）。
![位段](/c/bit.png)
注意：<br/>
①给位段赋值注意位段的范围，比如data.a = 8;因为a只占2位，最大值为3，所以把8（二进制位1000）赋给它时，只会取其低2位，所以data.a的值为0.<br/>
②声明位段的一般形式： 类型名 [成员名]:宽度		(方括号代表可省成员名即可以定义无名位段，位段的类型名只能是unsigned int或int类型)<br/>
③ 一个位段必须存储在同一存储单元中，不能跨两个单元。如果第一个单元空间不能容纳下一个位段，则该空间不用，而从下一个单元起存放该位段。(“存储单元”就是机器字，可能是1个字节，也可能是2个字节，视不同的编译系统而异)<br/>
④若某一位段要从另一个字开始存放，可用以下形式定义：<br/>
unsigned a：1；<br/>
unsigned　b：2；一个存储单元<br/>
unsigned：0； 表示本单元不再存放数据<br/>
unsigned　c：3；另一存储单元<br/>
![位段](/c/bit2.png)
⑤ 位段的长度不能大于存储单元，也不能定义位段数组。<br/>
⑥ 位段可以用整型格式符输出。<br/>
⑦位段可以在数值表达式中引用，它会被系统自动地转换成整型数。<br/>
⑧ 位段定义的第一个位段长度不能为0。<br/>

